You are working inside the â€œDealFlowLifecyclev1â€ monorepo I just opened on Replit.  
Stack recap:

â€¢ server/:  NodeÂ 18, ExpressÂ 5, Drizzleâ€‘ORMâ€¯(PostgreSQL), Pino logger  
â€¢ client/:  ReactÂ 18 + Vite + TypeScript, Tailwind + shadcn, TanStackÂ Query  
â€¢ shared/: typeâ€‘safe enums & Zod schemas  
â€¢ db/:     drizzle migrations folder

### GOAL
Apply the **P0 priority fixes** identified in the latest architecture review.

### CHECKLIST  (work topâ€‘toâ€‘bottom)

1. **Database constraints**  
   â˜  add `CHECK (call_pct > 0 AND call_pct <= 100)` to `capital_calls`  
   â˜  add unique composite index `(investment_id, due_date)` to `capital_calls`  
   â˜  generate & commit a new Drizzle migration

2. **Auth / RBAC guards**  
   â˜  import `requireAuth`Â &Â `authorizeRole` middleware in every new route:  
      â€¢ `server/routes/capitalCalls.ts` (`create`, `pay`)  
      â€¢ `server/routes/timeline.ts`   (`answer question`)  
   â˜  default role list should be `['analyst','admin','partner']`

3. **Overâ€‘payment guard**  
   â˜  in `PATCH /capital-calls/:id/pay` verify `amount <= outstanding_usd`;  
      return `400 { error:'overPayment' }` on violation.

4. **Remove duplicate overdue cron**  
   â˜  delete `cron/capitalCallOverdue.ts` and its scheduler entry  
   â˜  ensure the view `capital_calls_v` now drives overdue status

5. **Reactâ€‘Query invalidation**  
   â˜  after `createCalls` and `payCall` mutations also invalidate  
      `['fundStats', fundId]` and `['investment', investmentId]`

6. **Standard error envelope**  
   â˜  add Express errorâ€‘handling middleware that converts all thrown objects  
      into `{ error: { code, message } }` JSON  
   â˜  update `fetchJson` helper in `client/src/lib/api.ts` to parse that shape

### WORKFLOW rules for you, ReplitÂ AI

* Always create or update migrations viaÂ Drizzle CLI (`pnpm drizzle-kit generate:pg`).  
* Run `pnpm lint && pnpm test` before every suggested commit.  
* Use optimistic updates in React where possible (see usePayCall).  
* Touch no P1/P2 items until every checkbox above is green.

Iâ€™ll test each item manually once you ping â€œâœ…Â P0 completeâ€.

Good luckÂ ðŸš€
